<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Bird</title>
</head>
<body>

<wrapper class="wrapper">
    <header>
        <a href="index.html" id="logo">
            <img src="travelBirdsLogo.png" alt="Travel Birds logo">
        </a>
        <nav>
            <a href="#" class="toggleNav"><i class="fa fa-bars" aria-hidden="true"></i></a>
            <div id="navitems">
                <ul>
                    <a href="findFlight.html">Flights</a>
                    <a href="#">Hotel</a>
                    <a href="#">Car Rental</a>

                    <a id="faGlobe" href="#">Language</a>
                    <a href="login.html">Login</a>
                </ul>
            </div>
        </nav>
    </header>

    <div id="container">
        <div id="previousJourneys">
            <div class="secHeader">
                <h1>Flight Results</h1>
                <div class="button return"><a href="findFlight.html"> Search again</a></div>
            </div>
        </div>
    </div>
</wrapper>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="js/login.js"></script>
<script>

  //Get the JSON
  $.get('json/flights.json', function(oData) {
    //Search the array through for matches
    $.each(oData.flights, function(index, oFlight){
      if(oFlight.departure.includes(getUrlParameter('from')) || oFlight.arrival.includes(getUrlParameter('to'))) {
        var sFlightHtml =
        '<div class="journey">\
            <div class="departure">\
                Departure<br>\
                ' +oFlight.departure+ '<br>\
                ' +oFlight.departure_date+ '<br>\
                ' +oFlight.departure_time+ '\
            </div>\
            <div class="flight-icon"><i class="fa fa-plane fa-3" aria-hidden="true"></i></div>\
            <div class="arrival">\
                Arrival<br>\
                ' +oFlight.arrival+ '<br>\
                ' +oFlight.arrival_date+ '<br>\
                ' +oFlight.arrival_time+ '\
            </div>\
            <a href="payment.html" class="button pink">Book</a>\
        </div>';
        $('#previousJourneys').append(sFlightHtml);
      }
    });

    //If there is no journeys added, show "NO RESULTS"
    if($('.journey').length < 1) {
      var sFlightHtml =
      '<div class="journey">\
          NO RESULTS, TRY TO SEARCH AGAIN\
      </div>';
      $('#previousJourneys').append(sFlightHtml);
    }
  });

  $('.toggleNav').on('click', function () {
    $('nav ul').toggleClass('open');
  });

  //Get the parameter from the URL
  function getUrlParameter(sParam) {
    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
      sParameterName = sURLVariables[i].split('=');

      if (sParameterName[0] === sParam) {
        return sParameterName[1] === undefined ? true : sParameterName[1];
      }
    }
  }
</script>

</body>
</html>
